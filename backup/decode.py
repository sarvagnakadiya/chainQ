from web3 import Web3
import os
import json
from dotenv import load_dotenv
load_dotenv()
rpcUrl = os.getenv("RPC_URL")

# Connect to the Ethereum node
provider = Web3(Web3.HTTPProvider(rpcUrl))

# Path to the ABI JSON file
abi_file_path = os.path.join(os.path.dirname(__file__), 'ABIs', 'ERC721.json')

# Load the ABI from the JSON file
with open(abi_file_path, 'r') as abi_file:
    contract_abi = json.load(abi_file)
# Input data to decode (replace this with your actual input data)
input_data = "0x357a150b00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000160000000000000000000000000000000000000000000000000000000000000048000000000000000000000000000000000000000000000000000017b899c9270400000000000000000000000000000000000000000000000000000000064d290d600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a53496b67eec749ac41b4666d63228a0fb0409cf0000000000000000000000000000000000000000000000000000000000000000aa59fa39b4332fb8371b3597bbf97be71b6dd0ad2815a7cea809763204e336b76e83373bdc4499e87cdc18bac1a4c94f321428d7515163cba2294b25a0b110fa000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000f506e3991137046abb08016f0b907f20000000000000000000000000d73e0def01246b650d8a367a4b209be59c8be8ab0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000064f9ecb5000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001a000000000000000000000000000000000000000000000000000000000000001c05d841179ce335289f16af908f1abfe2ff9d7d4132ad889319f2a7a74dfd2d3db32d983d4f3eb350b93078d00b83b634a99a8f5f93f52ccf4f51516fdc0677465000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000056bc75e2d6310000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000010000000000000000000000001dfe7ca09e99d10835bf73044a23b73fc20623df00000000000000000000000000000000000000000000000000000000000a2c40000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000056bc75e2d631000000407f6b2ad70eb04bb0960850739d259bf4f8e40949cc84329f593e9d79f78e7000000000000000000000000f849de01b080adc3a814fabe1e2087475cf2e35400000000000000000000000000000000000000000000000000000000000001600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000180000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000001388000000000000000000000000d823c605807cc5e6bd6fc0d7e4eea50d3e2d66cd"

# Function to decode input data using contract ABI
def decode_input_data(contract_abi, input_data):
    try:
        contract = provider.eth.contract(abi=contract_abi)
        decoded_input = contract.decode_function_input(input_data)
        return decoded_input
    except Exception as e:
        return f"Error decoding input data: {e}"

# Decode the input data
decoded_result = decode_input_data(contract_abi, input_data)
print("Decoded input data:", decoded_result)
